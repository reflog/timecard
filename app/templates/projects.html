{% extends "base.html" %}

{%block extra_css %}
<style type="text/css">
</style>
{% endblock %}
{%block extra_js%}
    <script type="text/javascript" src="/static/js/angular.js"></script>
    <script type="text/javascript" src="/static/js/angular-resource.js"></script>
    <script type="text/javascript" src="/static/js/projects.js"></script>
{% endblock %}


{% block content %}
<div ng-app='ProjectsApp' ng-controller="ProjectsController" ng-cloak>

{% include 'partials/project_digalog_inlines.html' %}


{% macro project_list(title,archived) %}
    <div class="row-fluid">
    <p class="nav nav-header">{{title}}
        {% if archived == 'false' %}
        <a class="link pull-right" ng-click="doShowAddDialog()"><i class="icon-plus"></i></a>
        {% endif %}
    </p>
    <ul class="nav nav-list projectsList" >
        <li ng-repeat="p in projects.objects|filter: {archived: {{archived}}}"
            ng-class="{active:p.id == currentProject.id}"
            ng-animate="'fade'">
                <div>
                    <a class="actionIcon" ng-click="toggleArchived(p)"><i class="icon-time"></i></a>
                    <a class="actionIcon" ng-click="doShowDeleteDialog(p)"><i class="icon-remove-circle"></i></a>
                </div>
            <a ng-click="selectProject(p)" ng-bind='p.name'></a>
            <span ng-show='p.id == currentProject.id'>
                <span ng-repeat="e in getEntries(p)" ng-bind='e.text' class="badge"></span>
            </span>
        </li>
    </ul>
    </div>
{% endmacro %}

<div class="row-fluid" >
    <div class="span3 ">
        {{project_list("Active Projects",'false')}}
        <hr />
        {{project_list("Archived Projects",'true')}}
    </div>
    <div class="span9" data-spy="scroll" data-target=".projectsList">
        <section ng-show='projects.objects.length == 0'>
            <div class="page-header">
                <h1>Nothing yet! Add a project...</h1>
            </div>
        </section>
        <section ng-show='currentProject.id != 0'>
            <div class="page-header">
                <h1 class="letterpress" ng-bind="'Project: ' + currentProject.name"></h1>
            </div>
             <form class="well form-inline shadowy"  ng-submit="addEntry()">
                <div class="control-group">
                  <label class="control-label">New Entry</label>
                  <div class="controls controls-row">
                    <input type="text" class="input-xxlarge" ng-model="newEntry.text" placeholder="Entry text" autofocus>
                    <input type="text" class="input-small" ng-model="newEntry.timeSpent" placeholder="Time spent">
                    <button type="submit" class="btn btn-success">+</button>
                  </div>
                </div>
              </form>
            </section>
            <section class='layered-paper shadowy' >
                <h2 class="letterpress" >Entries</h2>
            <div class="table_container" ng-repeat="(month,entries) in currentEntriesByMonth">
                <p id="title" ng-bind="monthNames[month]"></p>
                <table class="table table-striped table-bordered table-condensed">
                    <thead>
                    <tr>
                        <th>Date</th>
                        <th>Entry Text</th>
                        <th>Time spent</th>
                    </tr>
                    </thead>
                    <tbody>
                        <tr ng-repeat="e in entries|orderBy:'-createdAt'" ng-animate="'fade'">
                            <td ng-bind="e.createdAt"></td>
                            <td ng-bind="e.text"></td>
                            <td ng-bind="e.timeSpent"></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>
    </div>
</div>
</div>
{% endblock %}